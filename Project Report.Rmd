---
title: "Project Report"
author: "Eduardo Solano-Salgado"
date: "26/03/2020"
output: html_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{SAS setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
## Objective


## Introduction


## Data Source


## Analysis and Discussion


### Univariate Data Analysis

```{r}
library(readxl, logical.return=FALSE)
library(ggplot2, logical.return=FALSE)
library(dplyr, warn.conflicts=FALSE)

WC<- read_xlsx('WorldCup.xlsx')
```

##### World Cup Appearances Analysis
```{r}
Appearance<- pull(WC,7)

hist(Appearance, breaks = 5)
boxplot(Appearance, horizontal=TRUE)

#excluding the value
new_appr <- Appearance[Appearance!=0]
hist(new_appr, breaks = 10, xlab = 'Appearance')
boxplot(new_appr, horizontal = TRUE, xlab ='Appearance')
```
#####GDP Analysis
```{r}
GDP <- pull(WC,5)
is.na(GDP)
hist(GDP)
boxplot(GDP, horizontal = TRUE, na.rm = TRUE)
summary(GDP, na.rm = TRUE)
```
#####Star players Analysis
```{r}
star <- pull(WC,9)
hist(star)
boxplot(star, horizontal = TRUE)
summary(star)

#exclude value 0
new_star <- star[star!=0]
hist(new_star)
boxplot(new_star, horizontal = TRUE)
summary(new_star)
```
### Bivariate Data Analysis

##### Appearances and Number of Star Players
```{r}
z<- lm(Appearances~Stars,data=WC)

ggplot(WC, aes(Stars, Appearances))+geom_point(size=3, shape=16)+
  geom_abline(slope=z$coefficients[2], intercept=z$coefficients[1], color='red')

 cor(WC$Stars, WC$Appearances)
```

##### Gross Domestic Product and Appearances at the World Cup

##### Input the Worldcup data and data change for chisq
```{SAS}
FILENAME REFFILE '/folders/myfolders/sasuser.v94/WorldCup.xlsx';

PROC IMPORT DATAFILE=REFFILE
	DBMS=XLSX
	OUT=WORLDCUP;
	GETNAMES=YES;
RUN;

FILENAME REFFILE '/folders/myfolders/sasuser.v94/Data_for_chi_sqr_test.xlsx';

PROC IMPORT DATAFILE=REFFILE
	DBMS=XLSX
	OUT=CHISQ;
	GETNAMES=YES;
RUN;
```
##### Confederation and Result
```{SAS}
/* CHISQ TEST AND BARCHART FOR RESULT AND CONFEDERATION */
PROC FREQ DATA = WORLDCUP;
	TABLE RESULT * CONFEDERATION /  EXPECTED CHISQ NOROW NOCOL NOPERCENT
	PLOTS = FREQPLOT(TWOWAY = CLUSTER SCALE = PERCENT);
RUN;


/* CHANGE THE TABLE IN CHISQ TEST FOR RESULT AND CONFEDERATION*/
PROC FREQ DATA = CHISQ;
	TABLE RESULT * CONFEDERATION / EXPECTED CHISQ NOROW NOCOL NOPERCENT
	PLOTS = FREQPLOT(TWOWAY = CLUSTER SCALE = PERCENT);
RUN;
```

##### Conferation and Tier
```{SAS}
/* CHISQ TEST AND BARCHART FOR RESULT AND CONFEDERATION */
PROC FREQ DATA = WORLDCUP;
	TABLE CONFEDERATION * TIER /  EXPECTED CHISQ NOROW NOCOL NOPERCENT
	PLOTS = FREQPLOT(TWOWAY = CLUSTER SCALE = PERCENT);
RUN;


/* CHANGE THE TABLE IN CHISQ TEST FOR RESULT AND CONFEDERATION*/
PROC FREQ DATA = CHISQ;
	TABLE CONFEDERATION * TIER / EXPECTED CHISQ NOROW NOCOL NOPERCENT
	PLOTS = FREQPLOT(TWOWAY = CLUSTER SCALE = PERCENT);
RUN;
```

##### Result and Tier
```{SAS}
/* CHISQ TEST AND BARCHART FOR RESULT AND CONFEDERATION */
PROC FREQ DATA = WORLDCUP;
	TABLE TIER * RESULT /  EXPECTED CHISQ NOROW NOCOL NOPERCENT
	PLOTS = FREQPLOT(TWOWAY = CLUSTER SCALE = PERCENT);
RUN;


/* CHANGE THE TABLE IN CHISQ TEST FOR RESULT AND CONFEDERATION*/
PROC FREQ DATA = CHISQ;
	TABLE TIER * RESULT / EXPECTED CHISQ NOROW NOCOL NOPERCENT
	PLOTS = FREQPLOT(TWOWAY = CLUSTER SCALE = PERCENT);
RUN;
```

## Limitations


## Conclusion
